
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
      
      
      
      
        <link rel="next" href="data.md/">
      
      
        
      
      
      <link rel="icon" href="assets/images/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.7.0">
    
    
      
        <title>Holy Core - Documentation</title>
      
    
    
      <link rel="stylesheet" href="assets/stylesheets/main.618322db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Roboto:300,300i,400,400i,700,700i%7CRoboto+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Roboto";--md-code-font:"Roboto Mono"}</style>
      
    
    
      <link rel="stylesheet" href="styles/custom.css">
    
    <script>__md_scope=new URL(".",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
  </head>
  
  
    <body dir="ltr">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#holy-core-user-docs" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
    
      

  

<header class="md-header md-header--shadow" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="." title="Holy Core - Documentation" class="md-header__button md-logo" aria-label="Holy Core - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <span class="md-ellipsis">
            Holy Core - Documentation
          </span>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Holy Core - User Docs
            
          </span>
        </div>
      </div>
    </div>
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      
      
        <label class="md-header__button md-icon" for="__search">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        </label>
        <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
      
    
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    



<nav class="md-nav md-nav--primary" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="." title="Holy Core - Documentation" class="md-nav__button md-logo" aria-label="Holy Core - Documentation" data-md-component="logo">
      
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 8a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3 3 3 0 0 0 3 3m0 3.54C9.64 9.35 6.5 8 3 8v11c3.5 0 6.64 1.35 9 3.54 2.36-2.19 5.5-3.54 9-3.54V8c-3.5 0-6.64 1.35-9 3.54"/></svg>

    </a>
    Holy Core - Documentation
  </label>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  
  <span class="md-ellipsis">
    
  
    Holy Core - User Docs
  

    
  </span>
  
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="." class="md-nav__link md-nav__link--active">
        
  
  
  <span class="md-ellipsis">
    
  
    Holy Core - User Docs
  

    
  </span>
  
  

      </a>
      
        

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Key Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-platform-soc" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Platform / SoC
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-itself" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Itself
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-folder-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Folder Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Started
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-default-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Default Simulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-your-own-test-program" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writing Your Own Test Program
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running Unit Tests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-riscof-compliance-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running RISCOF Compliance Tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga-quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGA Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-boards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supported Boards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-generate-the-bitstream" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 — Generate the Bitstream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-flash-and-boot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 — Flash and Boot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-load-custom-programs-via-jtag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 — Load Custom Programs via JTAG
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holy-core-platform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Holy Core Platform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Holy Core Platform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-top-ios" class="md-nav__link">
    <span class="md-ellipsis">
      
        Description &amp; Top I/Os
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-interfaces-cache-usage-for-the-user-via-csrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        External interfaces: Cache Usage for the User (Via CSRs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#address-space" class="md-nav__link">
    <span class="md-ellipsis">
      
        Address space
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clocking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clocking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interrupts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interrupts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#platform-level-interrupt-controller-plic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Platform Level Interrupt Controller (PLIC)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-level-interrupt-controller-clint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Level Interrupt Controller (CLINT)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-traps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nested traps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-boot-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default BOOT sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-chip-debugging-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      
        On-chip Debugging Solutions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="On-chip Debugging Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debugging Setup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fpga-usage-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Usage Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGA Usage Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-actually-flash-the-holy-core-platform-on-my-fpga" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to actually flash the HOLY CORE platform on my FPGA?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to actually flash the HOLY CORE platform on my FPGA?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-you-use-xilinx-fpgas" class="md-nav__link">
    <span class="md-ellipsis">
      
        If you use xilinx FPGAs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-you-use-other-tools-than-xilinxs" class="md-nav__link">
    <span class="md-ellipsis">
      
        If you use other tools than Xilinx's
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-in-an-soc-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration in an SoC Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga-resources-usage-core-caches-and-soc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Resources Usage (Core, Caches and SoC)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Software Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Write &amp; Build
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-software" class="md-nav__link">
    <span class="md-ellipsis">
      
        Executing software
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help-misc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Help &amp; Misc
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Acknowledgements
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="data.md/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holy Core - Data Sheet
  

    
  </span>
  
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="dev_docs/" class="md-nav__link">
        
  
  
  <span class="md-ellipsis">
    
  
    Holy Core - Dev Docs
  

    
  </span>
  
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

<nav class="md-nav md-nav--secondary" aria-label="Table of contents">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      Table of contents
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#overview" class="md-nav__link">
    <span class="md-ellipsis">
      
        Overview
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Overview">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#project-key-features" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Key Features
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Project Key Features">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#the-platform-soc" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Platform / SoC
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#the-core-itself" class="md-nav__link">
    <span class="md-ellipsis">
      
        The Core Itself
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#project-folder-structure" class="md-nav__link">
    <span class="md-ellipsis">
      
        Project Folder Structure
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#getting-started" class="md-nav__link">
    <span class="md-ellipsis">
      
        Getting Started
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#quick-reference" class="md-nav__link">
    <span class="md-ellipsis">
      
        Quick Reference
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#prerequisites" class="md-nav__link">
    <span class="md-ellipsis">
      
        Prerequisites
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Prerequisites">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#simulation-quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        Simulation Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Simulation Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#running-the-default-simulation" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running the Default Simulation
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#writing-your-own-test-program" class="md-nav__link">
    <span class="md-ellipsis">
      
        Writing Your Own Test Program
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-unit-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running Unit Tests
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#running-riscof-compliance-tests" class="md-nav__link">
    <span class="md-ellipsis">
      
        Running RISCOF Compliance Tests
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga-quickstart" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Quickstart
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGA Quickstart">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#supported-boards" class="md-nav__link">
    <span class="md-ellipsis">
      
        Supported Boards
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-1-generate-the-bitstream" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 1 — Generate the Bitstream
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-2-flash-and-boot" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 2 — Flash and Boot
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#step-3-load-custom-programs-via-jtag" class="md-nav__link">
    <span class="md-ellipsis">
      
        Step 3 — Load Custom Programs via JTAG
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#holy-core-platform" class="md-nav__link">
    <span class="md-ellipsis">
      
        Holy Core Platform
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Holy Core Platform">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#description-top-ios" class="md-nav__link">
    <span class="md-ellipsis">
      
        Description &amp; Top I/Os
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#external-interfaces-cache-usage-for-the-user-via-csrs" class="md-nav__link">
    <span class="md-ellipsis">
      
        External interfaces: Cache Usage for the User (Via CSRs)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#address-space" class="md-nav__link">
    <span class="md-ellipsis">
      
        Address space
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#clocking" class="md-nav__link">
    <span class="md-ellipsis">
      
        Clocking
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#trapping" class="md-nav__link">
    <span class="md-ellipsis">
      
        Trapping
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#interrupts" class="md-nav__link">
    <span class="md-ellipsis">
      
        Interrupts
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Interrupts">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#platform-level-interrupt-controller-plic" class="md-nav__link">
    <span class="md-ellipsis">
      
        Platform Level Interrupt Controller (PLIC)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#core-level-interrupt-controller-clint" class="md-nav__link">
    <span class="md-ellipsis">
      
        Core Level Interrupt Controller (CLINT)
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#nested-traps" class="md-nav__link">
    <span class="md-ellipsis">
      
        Nested traps
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#default-boot-sequence" class="md-nav__link">
    <span class="md-ellipsis">
      
        Default BOOT sequence
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#on-chip-debugging-solutions" class="md-nav__link">
    <span class="md-ellipsis">
      
        On-chip Debugging Solutions
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="On-chip Debugging Solutions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#context" class="md-nav__link">
    <span class="md-ellipsis">
      
        Context
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#debugging-setup" class="md-nav__link">
    <span class="md-ellipsis">
      
        Debugging Setup
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#fpga-usage-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Usage Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="FPGA Usage Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#how-to-actually-flash-the-holy-core-platform-on-my-fpga" class="md-nav__link">
    <span class="md-ellipsis">
      
        How to actually flash the HOLY CORE platform on my FPGA?
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="How to actually flash the HOLY CORE platform on my FPGA?">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#if-you-use-xilinx-fpgas" class="md-nav__link">
    <span class="md-ellipsis">
      
        If you use xilinx FPGAs
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#if-you-use-other-tools-than-xilinxs" class="md-nav__link">
    <span class="md-ellipsis">
      
        If you use other tools than Xilinx's
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
        
          <li class="md-nav__item">
  <a href="#integration-in-an-soc-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Integration in an SoC Guidelines
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#fpga-resources-usage-core-caches-and-soc" class="md-nav__link">
    <span class="md-ellipsis">
      
        FPGA Resources Usage (Core, Caches and SoC)
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#software-guidelines" class="md-nav__link">
    <span class="md-ellipsis">
      
        Software Guidelines
      
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Software Guidelines">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#write-build" class="md-nav__link">
    <span class="md-ellipsis">
      
        Write &amp; Build
      
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#executing-software" class="md-nav__link">
    <span class="md-ellipsis">
      
        Executing software
      
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#help-misc" class="md-nav__link">
    <span class="md-ellipsis">
      
        Help &amp; Misc
      
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#acknowledgements" class="md-nav__link">
    <span class="md-ellipsis">
      
        Acknowledgements
      
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              
              <article class="md-content__inner md-typeset">
                
                  



<h1 id="holy-core-user-docs">Holy Core - User Docs</h1>
<p><img alt="banner" src="images/banner2.png" /></p>
<h2 id="overview">Overview</h2>
<p>The HOLY CORE is an <strong>MCU class</strong> open-source core, made for learning and experimentation purposes, targeting hobbyists and very high stakes and critical industrial applications, like running <strong>PONG</strong> or <strong>DOOM</strong>.</p>
<div class="admonition note">
<p class="admonition-title">Target Audience</p>
<p>The target audience of this document are people who <strong>just want to use the core in their own project</strong> (for whatever reason) or simply learn more about the HOLY CORE before building it / out of curiosity.</p>
<p><strong>If you are an RTL dev</strong> looking to modify the inner HDL of the HOLY CORE, refer to the <a href="./dev_docs/"><strong>DEV DOCS</strong></a>.</p>
<p><strong>If you are a learner</strong> and just want to <strong>build the core yourself</strong>, go back to <a href="https://github.com/0BAB1/HOLY_CORE_COURSE">the repo</a> and read the main "<strong>readme</strong>" file to start learning.</p>
</div>
<p>The system is not very configurable. It provides a fixed, slow and inefficient platform. Its only strength is that <strong>it works</strong>, is <strong>100% Compliant to RISC-V</strong> and is somewhat fast enough to <strong>run DOOM</strong> at slideshow grade speeds.</p>
<p>Are you still here? Do you still want to use this core? Good, <em>we don't need speed anyway, do we?</em>.</p>
<p>Jokes aside, even though the HOLY CORE was not built with any sort of optimisation in mind, it was built to work and actually be usable while still being as simple as it can be in its architecture.</p>
<p>You can easily modify it on the fly if you take a couple hours to figure out how the project is laid out, <strong>which is exactly what is explained in this document</strong> as well as in the <a href="dev_docs/">dev docs</a>.</p>
<h3 id="project-key-features">Project Key Features</h3>
<h4 id="the-platform-soc">The Platform / SoC</h4>
<p>The project comes with a <code>fpga/holy_top.sv</code> file. This main wrapper provides all the basics that surrounds the core.</p>
<ul>
<li>The HOLY CORE</li>
<li>A debug module (from Pulp Platform)</li>
<li>A CLINT (to have soft interrupts, timers and all that jazz)</li>
<li>A PLIC (to have external interrupts support)</li>
<li>A boot ROM</li>
<li>A software framework (<em>a shitty and non-flexible library</em>)</li>
<li>External access AXI &amp; AXI LITE interface for integration on larger SoCs with actual peripherals</li>
<li>The HOLY CORE Platform has <strong>no custom peripherals</strong> other than the ones listed above. Generic peripherals <strong>are yours to add</strong> depending on your needs. Guidelines are given in the document, see <a href="#getting-started">Getting Started</a>.</li>
</ul>
<h4 id="the-core-itself">The Core Itself</h4>
<ul>
<li>A 32-bit RISC-V CPU</li>
<li>100% RISC-V compliant (according to the RISCOF framework)</li>
<li>A single cycle CPU, so simple in its architecture that even I wonder how it even runs any program at all without breaking.</li>
<li>Supports base ISA + M extension + privileged ISA (RV32I_Zicsr Privileged)</li>
<li>Machine mode only</li>
</ul>
<h3 id="project-folder-structure">Project Folder Structure</h3>
<p>The HOLY CORE's repo is kinda special for you, user, as it was built primarily to <em>teach</em> its contents. The repo is thus divided in <strong>chapters</strong> but as a user, you'll mostly be interested in the latest one, in this case: the folder <strong>3_perf_edition/</strong>.</p>
<p>Each chapter is a "CPU project" in itself and you will only be concerned about what is in this subfolder.</p>
<div class="highlight"><pre><span></span><code>HOLY CORE COURSE
├── 0_single_cycle_edition          Not suitable for real use
│   ├── ...
├── 1_fpga_edition                  Not suitable for real use
│   ├── ...
├── &lt;latest_edition&gt;          Contains bugs on advanced programs
│   ├── ...
├── 3_perf_edition
│   ├── Dockerfile                  Helper to quickly run RISCOF tests
│   ├── example_programs            Contains example software and a makefile to build it 
│   ├── fpga                        Contains the holy_top.sv wrapper &amp; real program simulation utils for debugging
│   ├── hc_lib                      Holy Core&#39;s library
│   ├── Makefile                    To cleanup the project when needed
│   ├── packages                    Holy Core interface and types definitions
│   ├── readme.md                   informative document
│   ├── requirements.txt            some CI bloat
│   ├── riscof                      Compliance test utils
│   ├── src                         Actual HDL code is here
│   ├── tb                          Module unit testing and basic CORE testing (quicker than riscof for quick validations)
│   └── vendor                      Vendor pulled code
├── LICENSE                         
├── readme.md                       
├── setup.md                        
├── todo.md                         
└── user_docs
    ├── docs
    └── mkdocs.yml
</code></pre></div>
<h3 id="getting-started">Getting Started</h3>
<p>It depends on what you want to know.</p>
<ul>
<li>If you want a really quick guide to just build a bitstream in vivado / run basic simulation, go to the <a href="#quickstart">quickstart guide</a>.</li>
<li>If you have the holy core platform up and running and just want to know how to use it for your projects, start with <a href="#holy-core-platform">Using the Holy Core Platform</a></li>
<li>If you want to know how to build a HOLY CORE based SoC ang get it running on your own FPGA platform, without caring about the actual software usage (yet), go to the <a href="#fpga-usage-guidelines">Practical FPGA Usage Guidelines</a> section.</li>
</ul>
<h2 id="quickstart">Quickstart</h2>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Get the <em>HOLY CORE</em> running in simulation or on FPGA hardware. This part targets people who have the <strong>exact</strong> right setup and just want a quick demo running before moving on to actually using the core.</p>
</div>
<h3 id="quick-reference">Quick Reference</h3>
<table>
<thead>
<tr>
<th>Task</th>
<th>Command</th>
</tr>
</thead>
<tbody>
<tr>
<td>Run simulation</td>
<td><code>cd &lt;latest_edition&gt;/fpga &amp;&amp; make</code></td>
</tr>
<tr>
<td>Rebuild ROM</td>
<td><code>cd &lt;latest_edition&gt;/fpga/ROM &amp;&amp; make</code></td>
</tr>
<tr>
<td>Run unit tests</td>
<td><code>cd &lt;edition&gt;/tb &amp;&amp; pytest test_runner.py</code></td>
</tr>
<tr>
<td>Generate bitstream</td>
<td><code>vivado -source .../arty_S7/holy_vivado_setup.tcl</code></td>
</tr>
<tr>
<td>Start debug server</td>
<td><code>openocd -f .../arty_S7/holy_core_openocd.cfg</code></td>
</tr>
<tr>
<td>Load program via GDB</td>
<td><code>riscv64-unknown-elf-gdb &lt;elf&gt;</code> → <code>target remote :3333</code> → <code>load</code></td>
</tr>
</tbody>
</table>
<h3 id="prerequisites">Prerequisites</h3>
<p>Before you begin, make sure you have the appropriate tools installed depending on your target.</p>
<h4 id="simulation">Simulation</h4>
<ul>
<li><a href="https://docs.cocotb.org/">Cocotb</a> — Python-based hardware verification framework</li>
<li><a href="https://verilator.org/">Verilator</a> — open-source Verilog simulator</li>
<li><a href="http://gtkwave.sourceforge.net/">GTKWave</a> — waveform viewer (optional, for debugging, you can use your favorite tool here)</li>
</ul>
<h4 id="fpga">FPGA</h4>
<p>To use the <em>HOLY_CORE</em> on FPGA quickly, you need Vivado (Xilinx toolchain), required for quick bitstream generation using the TCL script.</p>
<p>The base SoC comes with a simple ROM that blinks an LED, to load other programs, you'll need to debug using the associated tools:</p>
<ul>
<li>OpenOCD — for JTAG debugging</li>
<li>RISC-V GCC toolchain (<code>riscv64-unknown-elf-gcc</code>)</li>
<li>A USB-JTAG adapter (e.g., Digilent HS2) for loading programs via GDB</li>
</ul>
<div class="admonition info">
<p class="admonition-title">Full Setup Instructions</p>
<p>See the <a href="https://github.com/0BAB1/HOLY_CORE_COURSE/blob/master/setup.md">Setup Manual/Prerequisites</a> for detailed installation steps.</p>
</div>
<h3 id="simulation-quickstart">Simulation Quickstart</h3>
<h4 id="running-the-default-simulation">Running the Default Simulation</h4>
<p>From the repository root:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;latest_edition&gt;/fpga
make
</code></pre></div>
<p>This compiles the boot ROM and runs the HOLY_CORE in simulation using Verilator and Cocotb.</p>
<h4 id="writing-your-own-test-program">Writing Your Own Test Program</h4>
<ol>
<li>
<p><strong>Edit the boot ROM assembly:</strong></p>
<div class="highlight"><pre><span></span><code>vim<span class="w"> </span>&lt;latest_edition&gt;/fpga/ROM/rom.S
</code></pre></div>
</li>
<li>
<p><strong>Recompile the ROM:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;latest_edition&gt;/fpga/ROM
make
</code></pre></div>
</li>
<li>
<p><strong>Run the simulation:</strong></p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>..
make
</code></pre></div>
</li>
</ol>
<h4 id="running-unit-tests">Running Unit Tests</h4>
<p>To run the module-level testbenches:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;edition&gt;/tb
pytest<span class="w"> </span>test_runner.py
</code></pre></div>
<p>This executes quick reference tests on individual modules, including a basic HOLY_CORE integration test.</p>
<h4 id="running-riscof-compliance-tests">Running RISCOF Compliance Tests</h4>
<p>For full ISA compliance verification:</p>
<div class="highlight"><pre><span></span><code><span class="nb">cd</span><span class="w"> </span>&lt;latest_edition&gt;/riscof
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Docker Available</p>
<p>A Docker container is provided for easy RISCOF setup. See the README in that directory for details.</p>
</div>
<h3 id="fpga-quickstart">FPGA Quickstart</h3>
<h4 id="supported-boards">Supported Boards</h4>
<table>
<thead>
<tr>
<th>Board</th>
<th>Status</th>
</tr>
</thead>
<tbody>
<tr>
<td>Arty S7</td>
<td><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2C6.5 2 2 6.5 2 12s4.5 10 10 10 10-4.5 10-10S17.5 2 12 2m-2 15-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8z"/></svg></span> Fully supported</td>
</tr>
<tr>
<td>Zybo Z720</td>
<td><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg></span> Needs update</td>
</tr>
<tr>
<td>Basys3</td>
<td><span class="twemoji"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 14h-2V9h2m0 9h-2v-2h2M1 21h22L12 2z"/></svg></span> Needs update</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Portability</p>
<p>The <code>&lt;latest_edition&gt;/fpga/holy_top.sv</code> module is vendor-agnostic. Vivado is only used to add peripherals (UART, etc.). You can create your own SoC in <code>fpga/&lt;your_platform&gt;/</code>. More infos in the more <a href="#integration-in-an-soc-guidelines">in depth guide</a></p>
</div>
<h4 id="step-1-generate-the-bitstream">Step 1 — Generate the Bitstream</h4>
<div class="highlight"><pre><span></span><code>vivado<span class="w"> </span>-source<span class="w"> </span>&lt;latest_edition&gt;/fpga/arty_S7/holy_vivado_setup.tcl
</code></pre></div>
<p>Vivado will create the block design and start synthesis/implementation automatically.</p>
<h4 id="step-2-flash-and-boot">Step 2 — Flash and Boot</h4>
<ol>
<li>Program the FPGA with the generated bitstream</li>
<li>Press the <strong>reset</strong> button (resets peripherals)</li>
<li>Release the CPU reset switch (<code>SW2</code> on Arty S7 — check your board's constraints file)</li>
</ol>
<p>The CPU starts execution at <code>PC = 0x0</code>, running the boot ROM. By default, this blinks an LED in a loop.</p>
<h4 id="step-3-load-custom-programs-via-jtag">Step 3 — Load Custom Programs via JTAG</h4>
<p>To run more complex software, use OpenOCD and GDB.</p>
<p><strong>Start the debug server:</strong></p>
<div class="highlight"><pre><span></span><code>openocd<span class="w"> </span>-f<span class="w"> </span>&lt;latest_edition&gt;/fpga/arty_S7/holy_core_openocd.cfg
</code></pre></div>
<div class="admonition warning">
<p class="admonition-title">JTAG Adapter Required</p>
<p>This requires a USB-JTAG adapter. The config is tested with <strong>Digilent HS2 rev. A</strong>.</p>
<p>If you have a different adapter, <a href="https://github.com/your-repo/holy-core/issues">open an issue</a> and we'll help you create a config file.</p>
</div>
<p><strong>Connect with GDB and load a program:</strong></p>
<div class="highlight"><pre><span></span><code>riscv64-unknown-elf-gdb<span class="w"> </span>&lt;latest_edition&gt;/example_programs/ping_pong/ping_pong.elf
</code></pre></div>
<div class="highlight"><pre><span></span><code>(gdb) target remote :3333
(gdb) load
(gdb) continue
</code></pre></div>
<p>The program is loaded at base address <code>0x80000000</code> and execution begins:</p>
<p><img alt="Interrupt-based shell test program" src="images/holy_shell.png" /></p>
<h2 id="holy-core-platform">Holy Core Platform</h2>
<h3 id="description-top-ios">Description &amp; Top I/Os</h3>
<p>Here is a scheme that recaps everything provided by the <code>holy_top.sv</code> top module:</p>
<p><img alt="platform scheme" src="images/real_soc.png" /></p>
<p>As stated earlier, the project "only" provides a <code>holy_top.sv</code> file that contains all mandatory peripherals to ensure the debug, interrupts and timer support, as well as a fixed boot ROM.</p>
<p>So let's just say <strong>you have complete freedom over the platform</strong> (<em>mainly because you have to add the basics like UART or GPIO <strong>by yourself</strong></em>).</p>
<p>Here are the ports you will have to work with:</p>
<table>
<thead>
<tr>
<th>Port</th>
<th>Direction</th>
<th>Width</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>clk</code></td>
<td>input</td>
<td>1</td>
<td>CPU clock</td>
</tr>
<tr>
<td><code>rst_n</code></td>
<td>input</td>
<td>1</td>
<td>Active low reset</td>
</tr>
<tr>
<td><code>periph_rst_n</code></td>
<td>input</td>
<td>1</td>
<td>Peripheral reset (active low)</td>
</tr>
<tr>
<td><code>m_axi_*</code></td>
<td>in/out</td>
<td>-</td>
<td>AXI4 Full interface to external RAM</td>
</tr>
<tr>
<td><code>m_axi_lite_*</code></td>
<td>in/out</td>
<td>-</td>
<td>AXI4-Lite interface (crossbar to external peripherals)</td>
</tr>
<tr>
<td><code>irq_in</code></td>
<td>input</td>
<td>NUM_IRQS</td>
<td>External interrupt requests</td>
</tr>
<tr>
<td><code>tck_i</code></td>
<td>input</td>
<td>1</td>
<td>(for debug module) JTAG clock</td>
</tr>
<tr>
<td><code>tms_i</code></td>
<td>input</td>
<td>1</td>
<td>(for debug module) JTAG mode select</td>
</tr>
<tr>
<td><code>trst_ni</code></td>
<td>input</td>
<td>1</td>
<td>(for debug module) JTAG reset (active low)</td>
</tr>
<tr>
<td><code>td_i</code></td>
<td>input</td>
<td>1</td>
<td>(for debug module) JTAG data in</td>
</tr>
<tr>
<td><code>td_o</code></td>
<td>output</td>
<td>1</td>
<td>(for debug module) JTAG data out</td>
</tr>
<tr>
<td><code>...</code></td>
<td>output</td>
<td>-</td>
<td>Some misc on chip debug signals (I gotta get rid of these one day but these are useful sometimes, so they remain)</td>
</tr>
<tr>
<td><code>tb_debug_req</code></td>
<td>input</td>
<td>1</td>
<td>"FPGA" test debug request to provoke a debug jump in a simulation environment</td>
</tr>
</tbody>
</table>
<p>Note that we separate peripheral and CPU reset. This is because I did not succeed in having one single reset signal. I gotta make a proper reset controller that handles this but for now, when using this platform, it is better to hold CPU reset and perform a proper complete peripheral reset before releasing the CPU.</p>
<div class="admonition question">
<p class="admonition-title">Where are the parameters?</p>
<p>"Parameters" are not described here, the reason is in the next sub section ;)</p>
</div>
<h3 id="external-interfaces-cache-usage-for-the-user-via-csrs">External interfaces: Cache Usage for the User (Via CSRs)</h3>
<p>Also note that we have <strong>2 interfaces to exchange data</strong> with the "outside world" (i.e. the rest of your SoC): <code>m_axi_*</code> and <code>m_axi_lite_*</code>.</p>
<p>This is because the HOLY CORE has a small yet existent cache system, one for instructions (I$) and one for data (D$).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>You can disable D$ by setting the <strong>ONLY PARAMETER OF THE ENTIRE HOLY CORE</strong>: <code>DCACHE_EN</code> to 0 in the holy core's instantiation in <code>holy_top.sv</code>. You can also set the cache sizes depending on available FPGA resources in <code>holy_core.sv</code> in the cache instantiations. This is a pretty straightforward process if you already did some HDL work before. Otherwise, go and follow the holy core course ;)</p>
</div>
<p>These caches MAY cause problems when trying to exchange data with MMIOs (data wise) and the debug module (instruction wise). These need to NOT be cached. This is why the HOLY CORE platform allows the user to set <strong>uncached ranges</strong> using the following CSRs:</p>
<table>
<thead>
<tr>
<th>CSR NAME</th>
<th>ADDRESS</th>
<th>ROLE</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>flush_cache</code></td>
<td>0x7c0</td>
<td>write 1 to flush the data cache</td>
</tr>
<tr>
<td><code>data_non_cachable_base</code></td>
<td>0x7c1</td>
<td>base addr of non cachable data space</td>
</tr>
<tr>
<td><code>data_non_cachable_limit</code></td>
<td>0x7c2</td>
<td>limit addr of non cachable space</td>
</tr>
<tr>
<td><code>instr_non_cachable_base</code></td>
<td>0x7c3</td>
<td>base addr of non cachable instruction space</td>
</tr>
<tr>
<td><code>instr_non_cachable_limit</code></td>
<td>0x7c4</td>
<td>limit addr of non cachable instruction space</td>
</tr>
</tbody>
</table>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>See <a href="#address-space">Address space section</a> for generic address layout.</p>
</div>
<p>For example, this code sets up everything except RAM space (starting at 0x80000000) and up as non cachable (this also sets PLIC as cachable, I gotta do something about that... but yeah who cares?)</p>
<div class="highlight"><pre><span></span><code># cache setup

li t0, 0x00000000
li t1, 0x7FFFFFFF
csrrw x0, 0x7C1, t0
csrrw x0, 0x7C2, t1
csrrw x0, 0x7C3, t0
csrrw x0, 0x7C4, t1
</code></pre></div>
<p>When you make a request to an uncached memory region, the request will be routed to the AXI LITE interface and if the requested address is in the cached range, it takes the AXI FULL route.</p>
<h3 id="address-space">Address space</h3>
<p>The <code>holy_top.sv</code> module is considered a basic SoC as it already has some peripherals. It comes with a basic fixed memory map.</p>
<p>Your own peripherals will be accessed via the "external" address space, through the TOP axi interfaces.</p>
<table>
<thead>
<tr>
<th>Region</th>
<th>Start Address</th>
<th>End Address</th>
<th>Do you have to add this?</th>
</tr>
</thead>
<tbody>
<tr>
<td>Boot ROM</td>
<td><code>0x00000000</code></td>
<td><code>0x0FFFFFFF</code></td>
<td>No, it's in <code>holy_top.sv</code></td>
</tr>
<tr>
<td>External Peripherals</td>
<td><code>0x10000000</code></td>
<td><code>0x2FFFFFFF</code></td>
<td>YES, <strong>LITE</strong> requests here will go STRAIGHT to the outside world!</td>
</tr>
<tr>
<td>Debug Module</td>
<td><code>0x30000000</code></td>
<td><code>0x3FFFFFFF</code></td>
<td>No, it's in <code>holy_top.sv</code></td>
</tr>
<tr>
<td>CLINT</td>
<td><code>0x40000000</code></td>
<td><code>0x7FFFFFFF</code></td>
<td>No, it's in <code>holy_top.sv</code></td>
</tr>
<tr>
<td>External RAM</td>
<td><code>0x80000000</code></td>
<td><code>0x8FFFFFFF</code></td>
<td>YES, <strong>LITE</strong> requests here will go STRAIGHT to the outside world!</td>
</tr>
<tr>
<td>PLIC</td>
<td><code>0x90000000</code></td>
<td><code>0xFFFFFFFF</code></td>
<td>No, it's in <code>holy_top.sv</code></td>
</tr>
</tbody>
</table>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>This <code>holy_top.sv</code> internal address map only applies to the <strong>AXI_LITE</strong> interface.</p>
<p>That's because, in theory, <strong>AXI FULL</strong> being <strong>ONLY USED to retrieve RAM stored data</strong>.</p>
<p>Therefore, <strong>AXI FULL requests coming from the HOLY CORE will ALL be DIRECTLY ROUTED to the main external <code>m_axi</code> interface</strong> as it has no business to do with the internal component that are all accesses via uncached transaction, i.e. via AXI LITE.</p>
<p>Refer to the <a href="#description-top-ios">scheme</a> for a better visual explaination.</p>
</div>
<h3 id="clocking">Clocking</h3>
<p>My tests on a Zybo Z7-20 and Arty S7-50 resulted in a max speed of <strong>32MHz</strong>, I usually run it at <strong>30MHz</strong> to make sure I close timing. This is slow but who cares?</p>
<p>Internal AXI "buses" run at the same speed as the HOLY CORE. Overall, the whole system runs at the same speed and a single clock is needed.</p>
<p>Because the CORE uses AXI interfaces, you can run the rest of your SoC at different clock speeds, as long as you have correct CDC techniques in place so that the axi handshakes happen without problems.</p>
<h3 id="trapping">Trapping</h3>
<p>When a trap is triggered, the HOLY CORE jumps to the <code>mtvec</code> CSRs stored address, no offset will be applied and the trap handler has to test <code>mcause</code> to determine what to do.</p>
<div class="admonition example">
<p class="admonition-title">Trap Example</p>
<p>You have the <code>example_programs/pong</code> example if you need software guidance on building interrupt software or guidance on handling exceptions.</p>
</div>
<p>The HOLY CORE will then be flagged as in "<strong>trap mode</strong>" and will only exit that mode when <code>mret</code> is detected.</p>
<div class="admonition bug">
<p class="admonition-title">Watch Out when Debugging!</p>
<p>This means if you trigger a trap or an exception during debugging, reset the core after debugging and before restarting your program to reset the trap mode and avoid weird execution problems.</p>
</div>
<h3 id="interrupts">Interrupts</h3>
<p><strong>The HOLY CORE supports all types of machine mode interrupts</strong> and you can configure these by the usual standard RISC-V procedure using the associated CSRs (mstatus, mie, etc.). Refer to the CSR list in this document or the RISC-V specs for more info and this will not be detailed here.</p>
<div class="admonition example">
<p class="admonition-title">Interrupt Example with UART</p>
<p>You have the <code>example_programs/pong</code> example if you need software guidance on building interrupt software.</p>
</div>
<p>If you read the top ports table, you saw that the <code>holy_top.sv</code> module has a <code>irq_in</code> port (<code>NUM_IRQS</code> wide). These are external interrupts coming from whatever peripheral you want, this can be a UART controller, a GPIO interface, etc.</p>
<p>These feed directly into the PLIC.</p>
<h4 id="platform-level-interrupt-controller-plic">Platform Level Interrupt Controller (PLIC)</h4>
<p>Asserts <code>ext_irq</code> on the core.</p>
<p>The PLIC takes external, async requests from <code>irq_in</code> and formulate a single clear and synchronous external interrupt request for the HOLY CORE.</p>
<p>In the trap handler, the HOLY CORE should then consult the PLIC to figure what peripheral caused the trap, handle it and then signal the PLIC this trap has been handled.</p>
<div class="admonition example">
<p class="admonition-title">Interrupt Example with UART</p>
<p>This procedure is used in the <code>example_programs/pong</code> example if you need software guidance on building interrupt software.</p>
</div>
<p>Here is the <code>PLIC</code> memory map:</p>
<table>
<thead>
<tr>
<th>Address Offset</th>
<th>Register</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0x0000</code></td>
<td><code>ENABLE</code></td>
<td>Bitmask: enables/disables each interrupt source. Bits <code>[NUM_IRQS-1:0]</code>.</td>
</tr>
<tr>
<td><code>0x0004</code></td>
<td><code>CONTEXT_CLAIM_COMPLETE</code></td>
<td>Read: claim highest priority pending IRQ. Write: complete IRQ by writing same ID back.</td>
</tr>
</tbody>
</table>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>This PLIC module is <strong>not 100% Compliant to the PLIC specs</strong> but implements all the basics to handle interrupts in a standards "ready to go" way. It lacks advanced settings like priorities but who cares.</p>
</div>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Note this PLIC <strong>latches</strong> on incoming request when IDLING, meaning the <strong>RISING EDGE</strong> on <code>irq_in</code> is what causes an external interrupt request, even if it goes down before the core had time to handle it. This behavior can be modified in the HDL pretty easily if needed, as it was quickly added after initial development (way more practical and adapted).</p>
</div>
<h4 id="core-level-interrupt-controller-clint">Core Level Interrupt Controller (CLINT)</h4>
<p>Asserts <code>soft_irq</code> and <code>timer_irq</code> on the core.</p>
<p>The CLINT is a standard one, pretty straightforward to use.</p>
<p>Some timer and time comparator registers are here to assert a timer interrupt (<code>timer_irq</code>). And a soft interrupt register will automatically assert <code>soft_irq</code>.</p>
<p>Here is the <code>CLINT</code> memory map:</p>
<table>
<thead>
<tr>
<th>Address Offset</th>
<th>Register</th>
<th>Description</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>0x0000</code></td>
<td><code>msip</code></td>
<td>Software interrupt, only the LSB will trigger the output interrupt request. Others will be ignored.</td>
</tr>
<tr>
<td><code>0x4000</code></td>
<td><code>mtimecmp[31:0]</code></td>
<td>Low word for the 64 bits <code>mtimecmp</code></td>
</tr>
<tr>
<td><code>0x4004</code></td>
<td><code>mtimecmp[63:32]</code></td>
<td>High word for the 64 bits <code>mtimecmp</code></td>
</tr>
<tr>
<td><code>0xBFF8</code></td>
<td><code>mtime[31:0]</code></td>
<td>Low word for the 64 bits <code>mtime</code></td>
</tr>
<tr>
<td><code>0xBFFC</code></td>
<td><code>mtime[63:32]</code></td>
<td>High word for the 64 bits <code>mtime</code></td>
</tr>
</tbody>
</table>
<h4 id="nested-traps">Nested traps</h4>
<p>No nested traps support, did you really think I would implement that?</p>
<h3 id="default-boot-sequence">Default BOOT sequence</h3>
<p>When booting (after releasing CPU reset), <strong>the default PC will be 0x0</strong> and <strong>All cache related CSRs</strong> will be set to declare the entire memory as non-cachable.</p>
<p>This means the first requests (instructions fetch) will go directly to the boot ROM through the internal AXI LITE interface.</p>
<p><img alt="boot reset release" src="images/boot.png" /></p>
<p><strong>By default, the BOOT ROM contains an infinite loop</strong> (<em>with some GPIO interaction to turn an LED on and off, to clearly signal the CPU is alive when using it on FPGA</em>).</p>
<p>The boot ROM can be modified in <code>./fpga/ROM/rom.S</code> where you'll have to run <code>make</code> to generate a verilog ROM from your assembly code. <strong>The ROM changes will only "apply" once you re-run the synthesis and implementation process.</strong></p>
<p>Having an infinite loop there "parks" the HOLY CORE and allows the user (you) to connect via OpenOCD/GDB and do whatever you want (especially load a program).</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>More information on debugging in <a href="#on-chip-debugging-solutions">On-chip Debugging Solutions</a>.</p>
</div>
<blockquote>
<p><em>TODO: add a real bootloading solution.</em></p>
</blockquote>
<h3 id="on-chip-debugging-solutions">On-chip Debugging Solutions</h3>
<h4 id="context">Context</h4>
<p>Here is a little scheme of the setup (Explanations below):</p>
<p><img alt="debug setup scheme" src="images/debug_setup.png" /></p>
<p>The debug module is a great tool here, it acts as a master in the SoC, meaning, while connected to it via a debugger, we can poke registers to inspect what is going on in the peripherals, read memory to check corruption or load an entirely new program in said memory! <strong>This is both extremely powerful and useful.</strong></p>
<p>This debug module can also send debug requests to the core, making the HOLY CORE jump to the debug module's address space where we can make the core do whatever we want, but this complexity is abstracted away to the user, all the user actually does is send GDB debug commands to poke around and control the core.</p>
<p>As stated before, by default, the CORE boots on the boot ROM where some infinite LED on/off loop awaits to put the core in a "parked" state (i.e. it will not go anywhere and stay stable).</p>
<p>To get out of this loop, one can use a debugger.</p>
<p>If you look closely at the SoC scheme or the top I/O table, you'll see some "JTAG SIGNALS" signals coming in and out of the <code>holy_top.sv</code> module.</p>
<p>These JTAG signals talk directly with the debug module, which is not mine and pulled from a <a href="https://github.com/pulp-platform/riscv-dbg">pulp platform's repo</a>.</p>
<p>The debug module's job is to translate JTAG debugging instructions into real CPU interactions to apply the said debugging instructions. This whole part is abstracted away for the user and is not relevant here.</p>
<h4 id="debugging-setup">Debugging Setup</h4>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Before doing all this, a working SoC with memory and some peripherals available is mandatory! Follow the <a href="#fpga-usage-guidelines">Practical FPGA Usage Guidelines</a> if you do not have this yet.</p>
</div>
<p>To debug the core, you need the system to be <strong>running</strong> (i.e. no reset) and the core to be in a stable state (e.g. running a program or parked in an infinite loop).</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>The section "<strong>Practical FPGA Usage Guidelines</strong>" will help you fulfill the first step of getting the core running and parked.</p>
</div>
<p>Once this is done, you need a way to generate <em>los famosos</em> "JTAG Signal" to debug the core. This will be done by a piece of software called <strong>OpenOCD</strong>. <strong>OpenOCD</strong>'s role is to serve as a translation layer between your main debugger (we'll come to that in a sec) and your system.</p>
<p>This software will run on your very own PC, from which you will conduct all debugging operations.</p>
<p><strong>But</strong>, you may already know that your computer does not have any way to transport JTAG signals. This is a very important observation, in fact, all our computers have is USB ports. Well, lucky us! Some cables exist for that (called JTAG programming cables). This module will translate USB signal into real JTAG signals that the on chip debug module will understand.</p>
<div class="admonition question">
<p class="admonition-title">Recommended JTAG Programming Cable</p>
<p>I recommend the <a href="https://digilent.com/shop/jtag-hs2-programming-cable/?srsltid=AfmBOopRQKkynhoaMc44hei6l6Xxn9C1UhXUiuifWvg7NbQkenarzsPX">HS2</a> because it's what I use, but you can use any cable that claims to convert USB into JTAG, just make sure it is supported by OpenOCD. I will not detail how to adapt the setup to other programming cables.</p>
</div>
<p>To recognize and use this cable, OpenOCD needs a config file, that is already written, but you may have to adapt it depending on your exact JTAG programming cable. You'll also need to route the JTAG signals from the cable into the <code>holy_top.sv</code> top ports using some FPGA constraints.</p>
<p>Once everything is plugged in correctly, run:</p>
<div class="highlight"><pre><span></span><code><span class="err">openocd</span><span class="w"> </span><span class="err">-f</span><span class="w"> </span><span class="err">./fpga/arty_S7/holy_core_openocd.cfg</span><span class="w"> </span>
</code></pre></div>
<p>With <code>holy_core_openocd.cfg</code> being the configuration file you adapted to your cable. <strong>OpenOCD should signal you it found the HOLY CORE</strong>'s debug module and that it's waiting for instructions.</p>
<p>You will then open gdb with an elf program you want to execute and connect like so:</p>
<div class="highlight"><pre><span></span><code>riscv64-unknown-elf-gdb<span class="w"> </span>./example_programs/pong/pong.elf

<span class="o">(</span>gdb<span class="o">)</span>target<span class="w"> </span>remote<span class="w"> </span>:3333

Remote<span class="w"> </span>debugging<span class="w"> </span>using<span class="w"> </span>:3333
0x800004a4<span class="w"> </span><span class="k">in</span><span class="w"> </span>main<span class="w"> </span><span class="o">()</span>

<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>load

Loading<span class="w"> </span>section<span class="w"> </span>.text,<span class="w"> </span>size<span class="w"> </span>0x72c<span class="w"> </span>lma<span class="w"> </span>0x80000000
Loading<span class="w"> </span>section<span class="w"> </span>.rodata,<span class="w"> </span>size<span class="w"> </span>0x10f<span class="w"> </span>lma<span class="w"> </span>0x8000072c
Loading<span class="w"> </span>section<span class="w"> </span>.rodata.str1.4,<span class="w"> </span>size<span class="w"> </span>0x3<span class="w"> </span>lma<span class="w"> </span>0x8000083c
Start<span class="w"> </span>address<span class="w"> </span>0x80000000,<span class="w"> </span>load<span class="w"> </span>size<span class="w"> </span><span class="m">2110</span>
Transfer<span class="w"> </span>rate:<span class="w"> </span><span class="m">294</span><span class="w"> </span>KB/sec,<span class="w"> </span><span class="m">703</span><span class="w"> </span>bytes/write.

<span class="o">(</span>gdb<span class="o">)</span><span class="w"> </span>c
Continuing.
</code></pre></div>
<p>And the program will then execute. You can use various GDB tricks to debug your programs, but these practical aspects are discussed in the software guidelines.</p>
<h2 id="fpga-usage-guidelines">FPGA Usage Guidelines</h2>
<p>This part of the user guide is made to guide SoC designers to integrate the HOLY CORE into their system and get it running.</p>
<p>Recommended FPGA board: <strong>Arty S7-50</strong>. More details below.</p>
<h3 id="how-to-actually-flash-the-holy-core-platform-on-my-fpga">How to actually flash the HOLY CORE platform on my FPGA?</h3>
<p>This sub-part will be divided in 2 use cases (Xilinx and non-xilinx) so you can start exploring solutions right away.</p>
<div class="admonition info">
<p class="admonition-title">Info</p>
<p>Before jumping into this part, take a minute to read the <a href="#description-top-ios">SoC description</a> section to know what "<em>product</em>" you are dealing with and what you actually need to implement.</p>
</div>
<div class="admonition warning">
<p class="admonition-title">Point of Attention Before Running Synthesis</p>
<p>The <code>holy_top.sv</code> top module comes with a bootROM to feed the core with some basic instructions when releasing the CPU reset. <strong>You should build the said ROM</strong> before running synth to get a verilog ROM output. Make sure you check the code being built before building. I suggest you create a nop loop or a LED on/off loop. More info in <a href="#default-boot-sequence">BOOT ROM the dedicated section</a>.</p>
</div>
<h4 id="if-you-use-xilinx-fpgas">If you use xilinx FPGAs</h4>
<p>Using Xilinx's FPGAs will greatly simplify the task for you. Even though the <code>holy_top.sv</code> module is the main output product here, the care had to be ported to FPGA to be tested, and lucky you, I use Xilinx tools, more specifically, an arty s7-50 embedding a Spartan7 FPGA, some RAM, etc...</p>
<p>That means you have full TCL scripts to build an entire pre-made SoC that has</p>
<ul>
<li>RAM support using (see warning below)</li>
<li>UART (and UART interrupts)</li>
<li>I2C controller</li>
<li>SPI controller</li>
<li>A huge AXI interconnect</li>
<li>An ILA for extreme debugging scenarios</li>
<li>etc...</li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>The RAM is only compatible with the <strong>ARTY S7-50</strong>, you'll need to get rid of this and add your own memory solution if you do not use this exact board.</p>
</div>
<p>To get this "starter SoC" going:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>HOLY_CORE_COURSE/<span class="o">)</span>$<span class="w"> </span>vivado<span class="w"> </span>-source<span class="w"> </span>vivado<span class="w"> </span>-source<span class="w"> </span>./3_perf_edition/fpga/arty_S7/holy_vivado_setup.tcl
</code></pre></div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The entire libraries were built for this specific SoC configuration (with Xilinx's IPs) as well!</p>
</div>
<p>If your board is not an arty, which is more than likely, you can still run the script, change the target and modify the few board dependent aspects, like the constraints and the RAM solution.</p>
<p>If you still want to build an SoC from scratch, import all the source files (don't forget package and vendor folders!) and use <code>holy_top.sv</code> or its plain verilog wrapper <code>holy_top.v</code> in your SoC. Then it's just a matter of connecting the top signals and interface just like you would do with any softcore on the market.</p>
<div class="admonition tip">
<p class="admonition-title">FPGA Targets Contributions</p>
<p>Contributions on this part are very welcome: If you make an SoC that works, don't hesitate to create a PR with a tcl script targeting your specific setup.</p>
</div>
<h4 id="if-you-use-other-tools-than-xilinxs">If you use other tools than Xilinx's</h4>
<p>In this use case, import all the source files (don't forget package and vendor folders!) and use the <code>holy_top.sv</code> or its plain verilog wrapper <code>holy_top.v</code> in your HDL / Design tool.</p>
<p>Then connect the top signals according to the <a href="./#description-top-ios">top signals table</a> (clock, resets, debug module signals if needed, ...) and connect peripherals using the AXI interfaces.</p>
<p>AXI Full interface is (in theory) only used to retrieve RAM data, you can connect that directly to a RAM slave.</p>
<p>If your synthesis tool does not provide any AXI LITE interconnect solutions, you will find some AXI Lite crossbar in the <code>vendor/</code> folder.</p>
<div class="admonition example">
<p class="admonition-title">Example</p>
<p>Use <code>holy_top.sv</code> to see an example of using the <strong>AXI Lite crossbar</strong>.</p>
</div>
<h3 id="integration-in-an-soc-guidelines">Integration in an SoC Guidelines</h3>
<p>This part aims at giving a quick easy to follow guide to get a basic demo running as quickly as possible on you own FPGA platform.</p>
<p>You'll need to connect the following top pins like so:</p>
<table>
<thead>
<tr>
<th>Port</th>
<th>What to do?</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>clk</code></td>
<td><strong>25MHz clock</strong> generated by whatever clocking solution (max is 30MHz, safe is 25MHz)</td>
</tr>
<tr>
<td><code>rst_n</code></td>
<td>Active low push button, preferably coming from a reset controller (should wait for <code>periph_rst_n</code> to be fully reset)</td>
</tr>
<tr>
<td><code>periph_rst_n</code></td>
<td>Active low switch, preferably coming from a reset controller</td>
</tr>
<tr>
<td><code>irq_in</code></td>
<td>Nothing / GND for basic applications</td>
</tr>
<tr>
<td><code>tck_i</code></td>
<td>Nothing / GND for basic applications</td>
</tr>
<tr>
<td><code>tms_i</code></td>
<td>Nothing / GND for basic applications</td>
</tr>
<tr>
<td><code>trst_ni</code></td>
<td>High (1) for basic applications</td>
</tr>
<tr>
<td><code>td_i</code></td>
<td>Nothing / GND for basic applications</td>
</tr>
<tr>
<td><code>td_o</code></td>
<td>Nothing / GND for basic applications</td>
</tr>
<tr>
<td><code>pc/pc_next/instruction</code></td>
<td>useful basic debug signal, plug in an ILA to see if the core runs at first</td>
</tr>
</tbody>
</table>
<p><strong>Regarding the AXI interfaces</strong>, you'll need an interconnect solution.</p>
<ul>
<li>The <code>AXI</code> interface only needs to be plugged to RAM (not mandatory as <a href="#external-interfaces-cache-usage-for-the-user-via-csrs">cache is disabled in CSRs</a> by default)</li>
<li>The external <code>AXI LITE</code> needs to go to a basic peripheral, like a GPIO controller connected to an LED (default GPIO address in holy core library is 0x10010000)</li>
</ul>
<p>Once this basic setup synths, you are ready to go, you should start to worry about what happens once you release the <code>rst_n</code>, the default BOOT scenario is described <a href="#default-boot-sequence">here</a>. Write a basic assembly program in the <a href="#default-boot-sequence">ROM</a> that turns the LED on and off to check if the core is indeed running.</p>
<p>First troubleshooting solutions if the HOLY CORE shows no signs of life is to leverage the simple yet useful debug signals like <code>pc</code> or <code>instruction</code> with an <strong>ILA</strong>, these signals mirror what the HOLY CORE pc is and what instruction is currently fetched.</p>
<p>Tools like Vivado provides easy "plug and play" AXI interconnect solutions. Here is an example of a working basic SoC built around <code>holy_top.sv</code> and the associated memory map:</p>
<p><img alt="vivado soc example" src="images/vivado_soc.png" /></p>
<h3 id="fpga-resources-usage-core-caches-and-soc">FPGA Resources Usage (Core, Caches and SoC)</h3>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>This data was gathered through Synthesis &amp; Implementation runs made on Vivado, targeting an ARTY S7-50 board.</p>
</div>
<p>The Holy Core itself is pretty small and uses 4K LUTs and 6K FFs.</p>
<p>With caches (noted '$' with I = Instruction and D = Data):</p>
<ul>
<li>D$: Add 604 LUTs + 500 FFs (and some BRAM ofc)</li>
<li>I$: Add 3520 LUTs + 2296 FFs (no BRAM)</li>
</ul>
<p>I$ is way larger because <strong>the HOLY CORE has no "Frontend",</strong> there is no speculative regime nor "prefetching" nonsense. Instead, instructions are fetched "on the fly", meaning the I$ behaves as a normal cache except we read in an <strong>async</strong> fashion (to avoid the BRAM's 1 cycle delay on each instruction fetch HIT, thus literally doubling performance of the I$), forcing the FPGA to synth the cache data as LUTs and FFs. I$ size thus has a huge impact on the system's footprint and performance.</p>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Note that caches also have <code>no_cache</code> version in the core's data path. This allows users to <a href="#external-interfaces-cache-usage-for-the-user-via-csrs">set non cachable range (using custom CSRs)</a>, when an Instruction fetch or a data request happens in these ranges, caches are bypassed and the request goes through these "no cache" modules. Both of these use around 600 LUTs and 50 FFs.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that the I$ is mandatory and the D$ is optional. Both caches can be modified in size (not the number of ways though).</p>
</div>
<p>Regarding the <strong>SoC</strong>, here is a more generic utilization report:</p>
<table>
<thead>
<tr>
<th>Module</th>
<th>LUTs</th>
<th>FFs</th>
</tr>
</thead>
<tbody>
<tr>
<td>ALL COMBINED</td>
<td>8651</td>
<td>5975</td>
</tr>
<tr>
<td>clint</td>
<td>129</td>
<td>226</td>
</tr>
<tr>
<td>core</td>
<td>6381</td>
<td>4528</td>
</tr>
<tr>
<td>internal AXI LITE crossbar</td>
<td>794</td>
<td>152</td>
</tr>
<tr>
<td>plic</td>
<td>35</td>
<td>75</td>
</tr>
<tr>
<td>debug_module + its AXI converter</td>
<td>1600</td>
<td>1000</td>
</tr>
</tbody>
</table>
<p>The final occupation will be determined by your peripherals. In vivado, everything is heavy, especially AXI smartconnects. My final SoC built by the TCL script is <strong>25K+ LUTs and FFs</strong>, which is pretty heavy, but this depends on your own SoC layout.</p>
<h2 id="software-guidelines">Software Guidelines</h2>
<h3 id="write-build">Write &amp; Build</h3>
<p>The HOLY CORE platform is as bare-metal as it gets.</p>
<p>Software is very "primitive", yet you can build (almost) any bare metal C program and run it.</p>
<p>Once you have a running SoC, the best way to get started is not through an extensive block of test but through examples.</p>
<p>You'll find many examples in the <code>example_programs/</code> folder. As well as a Makefile with all the right flags.</p>
<p>To build a program:</p>
<div class="highlight"><pre><span></span><code><span class="o">(</span>example_programs/<span class="o">)</span>$<span class="w"> </span>make<span class="w"> </span><span class="nv">APP</span><span class="o">=</span>&lt;hello_world&gt;
</code></pre></div>
<p>You can replace <strong>hello_world</strong> with your app's folder name. You need a <code>startup.S</code> assembly file that will do all the necessary stack and cache setup.</p>
<p>More complex apps will obviously need more setup, you can consult the <code>example_programs/doom-riscv</code> DOOM example to see how larger apps can be set up.</p>
<h3 id="executing-software">Executing software</h3>
<p>Once you have a valid <code>.elf</code> file you want to run, you'll need to load it into your system and order the HOLY CORE to execute it.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If you didn't read the <a href="#default-boot-sequence">boot</a> section, read it to have better context.</p>
</div>
<p>By default, the core should be executing whatever is in the <strong>BOOT ROM</strong> once you release reset, hopefully, an infinite loop.</p>
<p>The best way to load some other program if you didn't add any bootloading solution (like me), you should use the <a href="#on-chip-debugging-solutions">debugger</a>.</p>
<p>In the <code>holy_core.sv</code> top module, the debug module is a bus master by default and has the power of accessing your SoC through the <code>AXI_LITE</code> external interface, including your memory solution (e.g. BRAM, DRAM controller, etc). <a href="#on-chip-debugging-solutions">GDB and OpenOCD</a> will work as expected and will allow you to freely control the execution flow.</p>
<p>Adding a better bootloading solution is on my todo list.</p>
<h2 id="help-misc">Help &amp; Misc</h2>
<div class="grid cards">
<ul>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 21.5c-1.35-.85-3.8-1.5-5.5-1.5-1.65 0-3.35.3-4.75 1.05-.1.05-.15.05-.25.05-.25 0-.5-.25-.5-.5V6c.6-.45 1.25-.75 2-1 1.11-.35 2.33-.5 3.5-.5 1.95 0 4.05.4 5.5 1.5 1.45-1.1 3.55-1.5 5.5-1.5 1.17 0 2.39.15 3.5.5.75.25 1.4.55 2 1v14.6c0 .25-.25.5-.5.5-.1 0-.15 0-.25-.05-1.4-.75-3.1-1.05-4.75-1.05-1.7 0-4.15.65-5.5 1.5M12 8v11.5c1.35-.85 3.8-1.5 5.5-1.5 1.2 0 2.4.15 3.5.5V7c-1.1-.35-2.3-.5-3.5-.5-1.7 0-4.15.65-5.5 1.5m1 3.5c1.11-.68 2.6-1 4.5-1 .91 0 1.76.09 2.5.28V9.23c-.87-.15-1.71-.23-2.5-.23q-2.655 0-4.5.84zm4.5.17c-1.71 0-3.21.26-4.5.79v1.69c1.11-.65 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24v-1.5c-.87-.16-1.71-.23-2.5-.23m2.5 2.9c-.87-.16-1.71-.24-2.5-.24-1.83 0-3.33.27-4.5.8v1.69c1.11-.66 2.6-.99 4.5-.99 1.04 0 1.88.08 2.5.24z"/></svg></span> <strong>Documentation</strong></p>
<hr />
<p>A problem in the docs ? Open an <a href="https://github.com/0BAB1/HOLY_CORE_COURSE/issues">issue</a>.</p>
</li>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14 12h-4v-2h4m0 6h-4v-2h4m6-6h-2.81a6 6 0 0 0-1.82-1.96L17 4.41 15.59 3l-2.17 2.17a6 6 0 0 0-2.83 0L8.41 3 7 4.41l1.62 1.63C7.88 6.55 7.26 7.22 6.81 8H4v2h2.09c-.05.33-.09.66-.09 1v1H4v2h2v1c0 .34.04.67.09 1H4v2h2.81c1.04 1.79 2.97 3 5.19 3s4.15-1.21 5.19-3H20v-2h-2.09c.05-.33.09-.66.09-1v-1h2v-2h-2v-1c0-.34-.04-.67-.09-1H20z"/></svg></span> <strong>Issues &amp; Questions</strong></p>
<hr />
<p>Having troubles you can't fix ? <a href="https://github.com/your-repo/holy-core/issues">Open an issue</a> on GitHub.</p>
</li>
<li>
<p><span class="twemoji lg middle"><svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M6 3a3 3 0 0 1 3 3c0 1.31-.83 2.42-2 2.83v6.34c1.17.41 2 1.52 2 2.83a3 3 0 0 1-3 3 3 3 0 0 1-3-3c0-1.31.83-2.42 2-2.83V8.83A2.99 2.99 0 0 1 3 6a3 3 0 0 1 3-3m0 2a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1m0 12a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1m15 1a3 3 0 0 1-3 3 3 3 0 0 1-3-3c0-1.31.83-2.42 2-2.83V7h-2v3.25L10.75 6 15 1.75V5h2a2 2 0 0 1 2 2v8.17c1.17.41 2 1.52 2 2.83m-3-1a1 1 0 0 0-1 1 1 1 0 0 0 1 1 1 1 0 0 0 1-1 1 1 0 0 0-1-1"/></svg></span> <strong>Contributions</strong></p>
<hr />
<p>PRs are welcome! This is true for this docs, <a href="">adding tcl scripts</a> or <a href="dev_docs/#rtl-contributions-guidelines">contributing to the RTL, but make sure you check the guidelines</a>.</p>
</li>
</ul>
</div>
<h2 id="acknowledgements">Acknowledgements</h2>
<p>This User docs file was inspired (in its layout) by stnolting's one you can find <a href="https://stnolting.github.io/neorv32/">here</a>.</p>












                
              </article>
            </div>
          
          
  <script>var tabs=__md_get("__tabs");if(Array.isArray(tabs))e:for(var set of document.querySelectorAll(".tabbed-set")){var labels=set.querySelector(".tabbed-labels");for(var tab of tabs)for(var label of labels.getElementsByTagName("label"))if(label.innerText.trim()===tab){var input=document.getElementById(label.htmlFor);input.checked=!0;continue e}}</script>

<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
      </main>
      
        <footer class="md-footer">
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
    
    
      
      
      <script id="__config" type="application/json">{"annotate": null, "base": ".", "features": ["content.tabs.link"], "search": "assets/javascripts/workers/search.7a47a382.min.js", "tags": null, "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": null}</script>
    
    
      <script src="assets/javascripts/bundle.e71a0d61.min.js"></script>
      
    
  </body>
</html>